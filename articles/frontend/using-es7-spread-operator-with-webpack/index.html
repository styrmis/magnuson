<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge;chrome=1' http-equiv='X-UA-Compatible'>
    <meta content='width=device-width, initial-scale=1' name='viewport'>
    <title>Using the ES7 Spread Operator with Webpack</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/articles/feed.xml" />
    <link href="/stylesheets/all.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
  </head>
  <body>
    <nav class='navbar navbar-inverse navbar-static-top'>
      <div class='container'>
        <div class='navbar-header'>
          <button aria-controls='navbar' aria-expanded='false' class='navbar-toggle collapsed' data-target='#navbar' data-toggle='collapse' type='button'>
            <span class='sr-only'>Toggle navigation</span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </button>
          <a class='navbar-brand' href='/'>Stefan Magnuson</a>
        </div>
        <div class='collapse navbar-collapse' id='navbar'>
          <ul class='nav navbar-nav'>
            <li class='active'>
              <a href='/'>Home</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class='container'>
      <h1>Using the ES7 Spread Operator with Webpack</h1>
      <h2>The Problem</h2>
      
      <p>I&rsquo;m currently evaluating Redux as a means to tidy up a React app, and in
      following the examples in the docs came across the spread operator (<code>...</code>).</p>
      
      <p>In the following code the spread operator copies in all of the keys and values
      of the existing state, and allows us to extend it with a new value for <code>bold</code>:</p>
      <pre class="highlight plaintext"><code>const comment = (state, action) =&gt; {&#x000A;  switch (action.type) {&#x000A;    case 'COMMENT_TOGGLE_BOLD ':&#x000A;      return {&#x000A;        ...state,&#x000A;        bold: !state.bold&#x000A;      }&#x000A;    default:&#x000A;      return state&#x000A;  }&#x000A;}&#x000A;</code></pre>
      
      <p>Problem is, while I have set up Webpack 6 to succesfully transpile and bundle
      JSX and ES6 (ES2015), it fails to recognise this use of the spread operator as
      at time of writing it is still in the proposal stage:</p>
      <pre class="highlight plaintext"><code>Module build failed: SyntaxError: /.../assets/js/reducers/comments.js:&#x000A;Unexpected token (9:8)&#x000A;   7 |&#x000A;   8 |       return {&#x000A;&gt;  9 |         ...state,&#x000A;     |         ^&#x000A;  10 |         bold: !state.bold&#x000A;  11 |       }&#x000A;  12 |     default:&#x000A;</code></pre>
      
      <h2>A Quick Solution</h2>
      
      <p>The quickest solution I found to resolve this, after trying to add in specific
      plugins like <code>transform-object-rest-spread</code>, was to enable the <code>stage-2</code> preset:</p>
      <pre class="highlight plaintext"><code>npm install --save babel-preset-stage-2&#x000A;</code></pre>
      
      <p>And then in <code>webpack.config.js</code>:</p>
      <pre class="highlight plaintext"><code>module: {&#x000A;  loaders: [&#x000A;    {&#x000A;      test: /\.jsx?$/,&#x000A;      exclude: /node_modules/,&#x000A;      loader: 'babel-loader',&#x000A;      query: {&#x000A;        presets:[ 'es2015', 'react', 'stage-2' ]&#x000A;      }&#x000A;    }&#x000A;  ]&#x000A;}&#x000A;</code></pre>
      
      <p>Be aware that the additional operators and behaviour which this preset brings in
      may be subject to change&ndash;in this case I think the benefits of the spread
      operator in reducing boilerplate override those concerns, as the operator
      semantics appear likely to become standard before long.</p>
      <hr>
      <div class='text-center'>
        <p>Did you find this post useful? If you would like help with anything then you can contact me any time via <a href="https://twitter.com/styrmis" target="_blank">Twitter</a>.</p>
        <br>
        <br>
      </div>
    </div>
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-95628-24', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
